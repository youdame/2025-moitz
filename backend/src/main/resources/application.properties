spring.application.name=moitz

spring.profiles.group.dev=dev,devclient,db
spring.profiles.group.prod=prod,client,db

spring.redis.host= 127.0.0.1
spring.redis.port= 6379
spring.redis.timeout=60000ms

logging.file.debug.path=./logs/debug
logging.file.info.path=./logs/info
logging.file.warn.path=./logs/warn
logging.file.error.path=./logs/error

management.endpoints.web.base-path=/
management.endpoints.web.exposure.include=health,metrics
management.endpoints.enabled-by-default=false
management.endpoint.health.enabled=true
management.endpoint.metrics.enabled=true

management.metrics.export.cloudwatch.enabled=true
management.metrics.export.cloudwatch.namespace=Moitz2025Dev
management.metrics.export.cloudwatch.step=30s
management.metrics.export.cloudwatch.region=ap-northeast-2
management.metrics.tags.app=moitz
management.metrics.tags.env=dev

spring.data.mongodb.auto-index-creation=true

spring.data.mongodb.connection-timeout=15000
spring.data.mongodb.socket-timeout=30000
spring.data.mongodb.server-selection-timeout=10000
spring.data.mongodb.max-wait-time=15000

spring.data.mongodb.max-connection-pool-size=15
spring.data.mongodb.min-connection-pool-size=3
spring.data.mongodb.max-connection-idle-time=300000

spring.data.mongodb.max-connection-life-time=600000
spring.data.mongodb.heartbeat-frequency=30000
spring.data.mongodb.min-heartbeat-frequency=10000

spring.data.mongodb.read-preference=primaryPreferred
spring.data.mongodb.read-concern=local

resilience4j.circuitbreaker.configs.default.slidingWindowType=COUNT_BASED
resilience4j.circuitbreaker.configs.default.slidingWindowSize=5
resilience4j.circuitbreaker.configs.default.failureRateThreshold=60
resilience4j.circuitbreaker.configs.default.waitDurationInOpenState=30s
resilience4j.circuitbreaker.configs.default.permittedNumberOfCallsInHalfOpenState=2
resilience4j.circuitbreaker.configs.default.minimumNumberOfCalls=5

resilience4j.circuitbreaker.instances.gemini.baseConfig=default
resilience4j.circuitbreaker.instances.gemini.slidingWindowSize=1
resilience4j.circuitbreaker.instances.gemini.failureRateThreshold=50
resilience4j.circuitbreaker.instances.gemini.minimumNumberOfCalls=1
resilience4j.circuitbreaker.instances.gemini.recordExceptions=com.f12.moitz.common.error.exception.ExternalApiException
resilience4j.circuitbreaker.instances.gemini.ignoreExceptions=com.f12.moitz.common.error.exception.RetryableApiException

resilience4j.circuitbreaker.instances.geminiRetryable.baseConfig=default
resilience4j.circuitbreaker.instances.geminiRetryable.recordExceptions=com.f12.moitz.common.error.exception.RetryableApiException
resilience4j.circuitbreaker.instances.geminiRetryable.ignoreExceptions=com.f12.moitz.common.error.exception.ExternalApiException,io.github.resilience4j.circuitbreaker.CallNotPermittedException
